#!/bin/bash

# Natura Real API Scraper
# Uses the official Natura Mexico API to get real products

API_URL="${API_URL:-http://localhost:8080}"
NATURA_API_BASE="https://ncf-apigw.natura-mx-jcf-prd.naturacloud.com/bff-app-natura-mexico-v2"
BEARER_TOKEN="Bearer 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"
TENANT_ID="mexico-natura-web"
API_KEY="3e28babd-85e9-4557-bfdd-450edf372306"

echo "üåø Natura Real API Scraper with Cloudinary Upload"
echo "üì° Backend API: $API_URL"
echo "üîó Natura API: $NATURA_API_BASE"
echo ""

# Load Cloudinary configuration
CLOUDINARY_CONFIG_FILE="${CLOUDINARY_CONFIG_FILE:-../backend/.env}"
if [ ! -f "$CLOUDINARY_CONFIG_FILE" ]; then
    echo "‚ùå .env file not found at $CLOUDINARY_CONFIG_FILE"
    echo "üí° Create backend/.env with Cloudinary configuration"
    exit 1
fi

# Source the .env file
set -a
source "$CLOUDINARY_CONFIG_FILE"
set +a

if [ -z "${CLOUDINARY_CLOUD_NAME:-}" ] || [ -z "${CLOUDINARY_API_KEY:-}" ] || [ -z "${CLOUDINARY_API_SECRET:-}" ]; then
    echo "‚ùå Missing Cloudinary configuration in $CLOUDINARY_CONFIG_FILE"
    echo "üí° Required: CLOUDINARY_CLOUD_NAME, CLOUDINARY_API_KEY, CLOUDINARY_API_SECRET"
    exit 1
fi

echo "‚òÅÔ∏è  Cloudinary Cloud: $CLOUDINARY_CLOUD_NAME"
echo ""
